{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>طراحان</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="shortcut icon" href="{% static '/assets/tarahanIcon-thsqZuN2.svg' %}" type="image/x-icon">
  <script type="module" crossorigin src="{% static '/assets/output-22b6PNpL.js' %}"></script>
  <link rel="stylesheet" crossorigin href="{% static '/assets/alert.css' %}">
  <script type="module" crossorigin src="{% static '/assets/main-Acrfd2WL.js' %}"></script>
  <link rel="stylesheet" crossorigin href="{% static '/assets/output-xplU_3MA.css' %}">
</head>
<body dir="rtl">
  {% include 'nav.html' %}
    <nav class="w-full h-14 shadow-[0px_4px_4px_0px_rgba(0,0,0,0.15)] px-4 hidden lg:flex justify-between items-center relative">
      <a href="{% url 'website:home' %}">
      <img src="{% static '/images/tarahanIcon.svg' %}" alt="" class="size-10 aspect-square">
      </a>
      <button class="flex flex-col justify-around w-6 h-6 bg-transparent border-none cursor-pointer z-10 focus:outline-none" id="hamburger">
        <span class="block w-6 h-0.5 bg-black transition-transform duration-500 ease-in-out"></span>
        <span class="block w-6 h-0.5 bg-black transition-transform duration-500 ease-in-out"></span>
        <span class="block w-6 h-0.5 bg-black transition-transform duration-500 ease-in-out"></span>
      </button>    
    </nav>
    {% include 'Phone.html' %}
    <section class="px-36 2xl:px-10 py-4 bg-secondary h-28 flex justify-center md:!px-3 md:h-fit md:py-2 ">
        <div class="w-full h-full bg-secondary ">
            <h1 class="text-3xl font-extrabold text-primary md:text-lg">
                بروز رسانی سبد خرید
            </h1>
            <div class="w-full h-fit flex items-center gap-1 text-xl font-normal text-primary mt-2 cursor-pointer md:text-sm">
                <a href="{% url 'website:home' %}">
                    خانه
                </a>
                <img src="data:image/svg+xml,%3csvg%20width='22'%20height='22'%20viewBox='0%200%2022%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3crect%20width='22'%20height='22'%20transform='matrix(1%200%200%20-1%200%2022)'%20fill='url(%23pattern0)'/%3e%3cdefs%3e%3cpattern%20id='pattern0'%20patternContentUnits='objectBoundingBox'%20width='1'%20height='1'%3e%3cuse%20xlink:href='%23image0_638_2126'%20transform='scale(0.0192308)'/%3e%3c/pattern%3e%3cimage%20id='image0_638_2126'%20width='52'%20height='52'%20xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtElEQVR4nO3ZwQnCQBCF4alJD7Ggt38NuXm1WcUOFFHQg4mKh51Z3gdbwM9MwpJEmJmZLQMmYI4RSNq21k7ApbV2iFFieJyyUXoTUzZKKzHlori/AM5rMS9nLj8ZnucWPUVWckxS8mSSkieTlDyZpOTJJCVPJjFgAxy/vWxK2kV2OApPqhu8fnj9uvH64fXrx+uH16+foT4F//hM7aMS1qNqxXyIqhmzEFU7ZsifxmZmFn+6Ajj7X4aUiCzdAAAAAElFTkSuQmCC'/%3e%3c/defs%3e%3c/svg%3e" class="size-4" alt="">
                <a href="{% url 'cart:cart' %}">سبد خرید</a>
            </div>
        </div>
    </section>
    <main class="w-full h-fit px-48 2xl:px-16 md:!px-0 py-10 md:py-5 flex flex-col gap-10 md:gap-5 items-center bg-tertiary">
      <section class="md:w-11/12 w-10/12 md:grid-rows-auto rounded-3xl bg-secondary h-fit grid grid-cols-3 md:grid-cols-1 gap-10 md:gap-5 p-8 md:p-4 md:flex-col-reverse">
        <div class="w-full col-span-2 md:col-span-1 md:w-full min-h-full h-full flex flex-col  justify-between">
          <div class="w-full flex flex-col gap-5">
            <div class="w-full flex justify-between">
              <h2 class="text-primary text-3xl md:text-xl font-extrabold">{{product.title}}</h2>
              <h5 class="text-primary text-lg  font-bold flex justify-center items-center">کد محصول: <span class="mr-5">{{product.product_code}}</span></h5>
            </div>
            <ul class="list-disc pr-10 text-primary text-lg md:text-base font-medium">
              {% if product.dimensions.length %}
                <li>
                  طول : {{ product.dimensions.get_length_display }}
                </li>
              {% endif %}
              {% if product.dimensions.width %}
                <li>
                  عرض : {{ product.dimensions.get_width_display }}
                </li>
              {% endif %}
              {% if product.dimensions.thickness %}
                <li>
                  ضخامت : {{ product.dimensions.get_thickness_display }}
                </li>
              {% endif %}
              {% if product.number_of_panels %}
                <li>
                  تعداد پنل ها :  {{ product.number_of_panels }}
                </li>
              {% endif %}
              <li>
                {{ product.description }}
              </li>
            </ul>
            
          </div>
          <div class="w-full flex flex-col items-end">
            {% if user.is_authenticated %}
            {% if user.customer_type == 'wholesale' %}
              <span class="w-fit">
                قیمت هر {{ product.price.get_translated_unit }} : <span class="text-primary text-2xl md:text-sm font-bold"> {{ product.price.price_wholesale|intcomma }} تومان</span>
              </span>
            {% else %}
              <span class="w-fit">
                قیمت هر {{ product.price.get_translated_unit }} : <span class="text-primary text-2xl md:text-sm font-bold"> {{ product.price.price_retail|intcomma }} تومان</span>
              </span>
            {% endif %}
          {% else %}
            <span class="w-fit">
              قیمت هر {{ product.price.get_translated_unit }} : <span class="text-primary text-2xl md:text-sm font bold"> {{ product.price.price_retail|intcomma }} تومان</span>
            </span>
          {% endif %}
          
          </div>
        </div>
        <div class="w-full col-span-1 md:col-span-1 md:-order-1 md:w-full md:max-h-52 aspect-square md:pb-0 flex flex-col md:flex-row rounded-3xl bg-white pb-2">
          <!-- تصویر اصلی -->
          <img id="mainImage" src="{{ product.images.first.image.url }}" class="w-full md:w-[calc(100%-3.5rem)] md:aspect-video h-full aspect-square rounded-3xl object-cover" alt="{{ product.title }}">
          <div class="md:py-2">
            <!-- نمایش تصاویر دیگر -->
            <div class="w-full md:w-14 h-fit md:h-full flex overflow-y-scroll md:flex-col md:overflow-x-scroll gap-2 md:mt-0 mt-2 px-2 items-center removeScrollBar" id="scrollableDiv">
              {% for image in product.images.all %}
                <img src="{{ image.image.url }}" onclick="changeMainImage('{{ image.image.url }}')" class="size-14 aspect-square rounded-lg object-cover" alt="">
              {% endfor %}
            </div>
          </div>
        </div>
        
        <script>
          function changeMainImage(newImageUrl) {
            // Get the main image element
            var mainImage = document.getElementById('mainImage');
            
            // Change the source of the main image to the clicked image
            mainImage.src = newImageUrl;
          }
        </script>
        
          </div>
        </div>
        
      </section>
      <section class="w-10/12 md:w-11/12 h-fit bg-secondary p-10 md:p-5 grid grid-cols-2 md:grid-cols-1 gap-5 rounded-4xl">
        {% if class_name == 'Customcurtain' %}
        <input type="text" name="length" class="w-full bg-tertiary h-14 rounded-lg px-5 placeholder:text-lg font-semibold placeholder:text-senary placeholder:mr-5 !outline-none !border-none" placeholder="طول پرده">
        <input type="text" name="width" class="w-full bg-tertiary h-14 rounded-lg px-5 placeholder:text-lg font-semibold placeholder:text-senary placeholder:mr-5 !outline-none !border-none" placeholder="عرض پرده">
        <input type="text" name="number_of_panels" class="w-full bg-tertiary h-14 rounded-lg px-5 placeholder:text-lg font-semibold placeholder:text-senary placeholder:mr-5 !outline-none !border-none" placeholder="تعداد پنل مورد نیاز">
        <div class="w-full h-14 flex gap-5 items-center">
            <span class="text-primary text-lg md:text-xl font bold">آیا به چوب پرده نیاز دارید؟</span>
            <input type="checkbox" name="needs_curtain_rod" id="" class="size-5">
        </div>
        {% endif %}
    
    
        <form method="post" action="{% url 'cart:add' product_id=product.id %}">
          {% csrf_token %}
        <div class="w-full h-14 flex gap-5 items-center">
          <button id="colorButton" class="text-primary bg-tertiary px-5 py-1 rounded-lg text-lg md:text-xl font bold">انتخاب رنگ</button>
          <input type="radio" name="color" id="color1" class="size-5" hidden >
          <input type="text" name="texture_code" value="{{product.textures.first}}" id="textureInput" class="size-5" hidden >

          <img src="{{ product.textures.first.image.url }}" class="size-14 object-cover rounded-xl" alt="" id="texturePreview">
        </div>
        <div class="w-full col-span-2 md:col-span-1 flex justify-between items-center">
          <div id="finalPrice" class="md:text-sm">
            قیمت نهایی: <span class="text-primary text-2xl md:text-sm font-bold">{% if user.is_authenticated %}{% if user.customer_type == 'wholesale' %}{{ product.price.price_wholesale|intcomma }} تومان</span>{% else %}{{ product.price.price_retail|intcomma }} تومان</span>{% endif %}{% else %}{{ product.price.price_retail|intcomma }} تومان</span>{% endif %}</span>
          </div>          
            <input type="hidden" name="product_id" value="{{ product.id }}">
            {% if user.is_authenticated %}
                {% if user.customer_type == 'wholesale' %}
                    <input type="hidden" name="price" value="{{ product.price.price_wholesale }}">
                {% else %}
                    <input type="hidden" name="price" value="{{ product.price.price_retail }}">
                {% endif %}
            {% else %}
                  <input type="hidden" name="price" value="{{ product.price.price_retail }}">
            {% endif %}
            <div class="w-full h-14 flex gap-5 items-center">
              <div class="w-full h-14 flex gap-5 items-center">
                  <label for="quantity" class="text-primary text-lg md:text-xl font-bold">تعداد:</label>
                  <div class="flex items-center">
                    <input type="number" id="quantity" name="quantity" value="1" min="1" max="999999" class="w-24 bg-tertiary h-14 rounded-lg px-5 placeholder:text-lg font-semibold placeholder:text-senary placeholder:mr-5 !outline-none !border-none text-center" oninput="updateFinalPrice()">
                  </div>
                </div>
            </div>
            <button type="submit" class=" bg-white rounded-lg flex justify-center items-center md:text-sm md:px-3 px-5 py-2 font-extrabold text-xl text-senary">افزودن به سبد</button>
          </div>
        </form>
        </section>
      <script>
        document.getElementById('colorButton').addEventListener('click', function(event) {
            event.preventDefault(); // Prevent the default form submission
            // Your logic for handling color selection goes here
        });
    </script>
    </main>
    
    {% include 'footer.html' %}
  <script src="{% static 'js/texturePreview.js' %}" defer></script>

<!-- Your existing HTML code for the dialog -->
<!-- Your existing HTML code for the dialog and selection elements -->
<dialog id="colorDialog" class="w-fit h-fit">
  <div class="w-full bg-quinary h-10 px-3 shadow-3xl flex items-center text-primary text-xl font bold">
    انتخاب رنگ
  </div>
  <div class="grid grid-cols-5 gap-5 p-3">
    {% for texture in product.textures.all %}
      <div class="chooseTexture" data-src="{{ texture.image.url }}" data-id="{{ texture}}">
        <div class="w-full">
          <img src="{{ texture.image.url }}" class="size-14 object-cover rounded-xl" alt="{{ texture}}" data-id="{{ texture }}">
          <span class="w-full text-center">
            {{ product.product_code }}{{ texture.code }}
          </span>
        </div>
      </div>
  {% endfor %}
  </div>
</dialog>

<!-- JavaScript for handling the color selection -->
<script>
  document.getElementById('incrementQuantity').addEventListener('click', function() {
    var quantityInput = document.getElementById('quantity');
    quantityInput.value = parseInt(quantityInput.value, 10) + 1;
  });

  document.getElementById('decrementQuantity').addEventListener('click', function() {
    var quantityInput = document.getElementById('quantity');
    var currentQuantity = parseInt(quantityInput.value, 10);
    quantityInput.value = currentQuantity > 1 ? currentQuantity - 1 : 1;
  });
</script>
<script>
  function updateFinalPrice() {
    var quantityInput = document.getElementById('quantity');
    var finalPriceElement = document.getElementById('finalPrice');
    var pricePerUnit = {% if user.is_authenticated and user.customer_type == 'wholesale' %}{{ product.price.price_wholesale }}{% else %}{{ product.price.price_retail }}{% endif %};
    
    var quantity = parseInt(quantityInput.value, 10);
    var totalPrice = quantity * pricePerUnit;
    
    finalPriceElement.innerHTML = 'قیمت نهایی: <span class="text-primary text-2xl md:text-sm font-bold">' + totalPrice.toLocaleString() + ' تومان</span>';
  }
</script>


    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
</body>
</html>




              
              